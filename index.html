<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <!-- CSS de Bootstrap-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />

        <style>
            @import url("https://fonts.googleapis.com/css2?family=Trispace:wght@300;400;600&display=swap");

            :root {
                --bs-body-font-family: "Trispace", sans-serif;
                --bs-body-color: #eef;
                --bs-body-bg: #10121c;
            }
            body{
                background-color: #183154;
            }
        </style>
        <title>Pre-entrega, Introducción al Desarrollo Front End con HTML, CSS y JavaScript</title>
    </head>
    <body>
        <div class="container-fluid" style="background-image: url(ocean_header.png); background-repeat: no-repeat; background-position: center; background-size: cover;">
            <div class="row h-100">
                <div class="div text-center my-auto">
                    <p><br><br></p>
                    <h1 class="display-4 text-center py-2">Emisiones de CO2</h1>
                    <h2 class="text-light">Acidificación de océanos y cambio climático</h2>
                    <p><br><br></p>
                </div>
            </div>
        </div>
        <header>
            <div class="container">
                <div class="row pt-5">
                    <div class="col-sm-10 col-md-8 col-lg-6 mx-auto">
                        <p class="lead">
                            Cinco gráficos construidos a partir de los datos de las emisiones de CO2, rescatando algunos de los países que más contribuyen a estas emisiones, y a Chile, para tener un punto de comparación.
                        </p>
                        <p>
                            El aumento en las emisiones humanas de dióxido de carbono en el último tiempo nos ha traido diversas consecuencias a nuestro mundo, como el cambio climático por ejemplo.<br>Algunos de los gráficos aquí mostrados alimentarán la página de la próxima clase, en donde se hablará de la acidificación de los océanos: una consecuencia directa de las cantidades de CO2 desmesuradas que han sido emitidas en este último tiempo y que cambian el pH de los océanos. 
                        </p>
                        <p>De los <a href="https://github.com/fant4sma/testeo/blob/main/co2_simplificado.csv" target="_blank" class="link-light">registros de emisiones de CO2 simplificadas</a>, podemos obtener algunos datos:</p>
                    </div>
                </div>
            </div>
        </header>

        <main class="container">
            <div class="accordion mx-md-5 my-5 rounded-0" id="accordionExample">
                <!--emisiones acumuladas de CO2 en total-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header bg-dark" id="headingOne">
                        <button class="accordion-button rounded-0" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Emisiones de CO2 acumuladas</button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Aqui se muestran las emisiones acumuladas de CO2 en total, resaltando algunos países. </p>
                            <canvas id="acumuladas" width="100" height="100" class="m-5"></canvas>
                        </div>
                    </div>
                </div>
                <!--emisiones de CO2 del mundo en el tiempo-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Emisiones CO2 del mundo en el tiempo</button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Aquí se muestran las emisiones de CO2 del mundo en función del tiempo</p>
                            <canvas id="mundo" width="100" height="100" class="m-5"></canvas>
                        </div>
                    </div>
                </div>
                <!--emisiones CO2 de Chile en el tiempo-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingThree">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">CO2 de Chile en el tiempo</button>
                    </h2>
                    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Aqui se muestran las emisiones de CO2 de Chile en función del tiempo.</p>
                            <canvas id="chile" width="100" height="100" class="m-5"></canvas>
                        </div>
                    </div>
                </div>
                <!--emisiones CO2 de Europa en el tiempo-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingFour">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">CO2 de Europa en el tiempo</button>
                    </h2>
                    <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Aqui se muestran las emisiones de CO2 de Europa en función del tiempo.</p>
                            <canvas id="eu" width="100" height="100" class="m-5"></canvas>
                        </div>
                    </div>
                </div>
                <!--emisiones CO2 de Estados Unidos en el tiempo-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingFive">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">CO2 de Estados Unidos en el tiempo</button>
                    </h2>
                    <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Aqui se muestran las emisiones de CO2 de Estados Unidos en función del tiempo.</p>
                            <canvas id="usa" width="100" height="100" class="m-5"></canvas>
                        </div>
                    </div>
                </div>
                <!--Fin-->
            </div>
            <div class="row">
                <div class="col-sm-10 col-md-8 col-lg-6 mx-auto">
                    <p>Estos han sido los cinco gráficos que conforman la pre entrega del día Jueves 5 de Mayo. </p>
                </div>
            </div>
        </main>

        <aside>
            <div class="container">
                <div class="row py-5">
                    <div class="col-sm-10 col-md-8 col-lg-6 mx-auto small text-center">
                        <p>
                            Fuente: <a href="https://ourworldindata.org/contributed-most-global-co2">Cummulative CO2 emissions</a>
                            
                        </p>
                    </div>
                </div>
            </div>
        </aside>

        <footer>
            <div class="container">
                <div class="row">
                    <div class="col"><p class="text-muted mt-5 text-center small">Bootstrap v5.1 y Charts.js</p></div>
                </div>
            </div>
        </footer>

        <!-- Biblioteca de Bootstrap -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <!-- Biblioteca Chart.js -->
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"
            integrity="sha512-QSkVNOCYLtj73J4hbmVoOV6KVZuMluZlioC+trLpewV8qMjsWqlIQvkn1KGX2StWvPMdWGBqim1xlC8krl1EKQ=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        ></script>
        <script>
            async function todo() {
                //el fetch
                const consulta = await fetch("https://raw.githubusercontent.com/fant4sma/testeo/main/datos_co2.json");
                const data = await consulta.json();
                //emisiones acumuladas en el tiempo
                var ac_china=0;
                var ac_india=0;
                var ac_usa=0;
                var ac_europe=0;
                var ac_chile=0;

                var anio_chile=[];
                var em_anio_chile=[];

                var anio_europe=[];
                var em_anio_europe=[];
            
                var anio_usa=[];
                var em_anio_usa=[];

                var anio_world=[];
                var em_anio_world=[];

                var ac_world=0;
                data.forEach(d => {
                    if (d.Entity=="China"){
                        ac_china=ac_china+d.Cumulative_CO2_emissions;
                    }
                    if (d.Entity=="India"){
                        ac_india=ac_india+d.Cumulative_CO2_emissions;
                    }
                    if (d.Entity=="United States"){
                        let str= String(d.Year)
                        ac_usa=ac_usa+d.Cumulative_CO2_emissions;
                        anio_usa.push(str);
                        em_anio_usa.push(d.Cumulative_CO2_emissions);
                    }
                    if (d.Entity=="Europe"){
                        let str= String(d.Year)
                        ac_europe=ac_europe+d.Cumulative_CO2_emissions;
                        anio_europe.push(str);
                        em_anio_europe.push(d.Cumulative_CO2_emissions);
                    }
                    if(d.Entity=="Chile"){
                        let str= String(d.Year)
                        ac_chile=ac_chile+d.Cumulative_CO2_emissions;
                        anio_chile.push(str);
                        em_anio_chile.push(d.Cumulative_CO2_emissions);
                    }
                    else if(d.Entity=="World"){
                        let str= String(d.Year)
                        ac_world=ac_world+d.Cumulative_CO2_emissions;
                        anio_world.push(str);
                        em_anio_world.push(d.Cumulative_CO2_emissions);
                    }
                });
                
                var otros=ac_world-ac_china-ac_europe-ac_chile-ac_india-ac_usa;


                /*
                    GRAFICOS
                */
                new Chart(document.getElementById("eu").getContext("2d"), {
                    type: "bar",
                    data: {
                        labels: anio_europe,
                        datasets: [
                        { data: em_anio_europe, label: "Europa", backgroundColor: ["#B75D21"] }
                        ],
                    },
                });

                new Chart(document.getElementById("acumuladas").getContext("2d"), {
                    type: "doughnut",
                    data: {
                        labels: ["Europa", "Estados Unidos", "China", "India", "Chile", "Otros"],
                        datasets: [{ data: [ac_europe, ac_usa, ac_china, ac_india, ac_chile, otros], label: "Emisiones de CO2 de algunos paises, en comparación con el total", backgroundColor: ["#a00", "#fc8d59", "#ffffbf", "#91bfdb", "#3A845F","#4A3889"] }],
                    },
                });

                new Chart(document.getElementById("chile").getContext("2d"), {
                    type: "line",
                    data: {
                        labels: anio_chile,
                        datasets: [
                        { data: em_anio_chile, label: "Chile", backgroundColor: ["#3E2599"] }
                        ],
                    },
                });

                new Chart(document.getElementById("mundo").getContext("2d"), {
                    type: "line",
                    data: {
                        labels: anio_world,
                        datasets: [
                        { data: em_anio_world, label: "Mundo", backgroundColor: ["#9ebcda"] }
                        ],
                    },
                });
                new Chart(document.getElementById("usa").getContext("2d"), {
                    type: "bar",
                    data: {
                        labels: anio_usa,
                        datasets: [
                        { data: em_anio_usa, label: "Estados Unidos", backgroundColor: ["#259940"] }
                        ],
                    },
                });
                
            }
            todo().catch((error) => console.error(error));
        </script>
    </body>
</html>